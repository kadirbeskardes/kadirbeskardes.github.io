@using System.Globalization
@using Personal.Services
@inject CultureService CultureService

<div class="dropdown culture-switcher">
    <button class="btn btn-outline-light btn-sm dropdown-toggle d-flex align-items-center" type="button" id="cultureDropdown" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="bi bi-globe me-1"></i>
        @GetCurrentCultureDisplay()
    </button>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="cultureDropdown">
        <li>
            <button class="dropdown-item @(IsCurrentCulture("tr-TR") ? "active" : "")" @onclick="@(() => ChangeCultureAsync("tr-TR"))">
                ðŸ‡¹ðŸ‡· TÃ¼rkÃ§e
            </button>
        </li>
        <li>
            <button class="dropdown-item @(IsCurrentCulture("en-US") ? "active" : "")" @onclick="@(() => ChangeCultureAsync("en-US"))">
                ðŸ‡ºðŸ‡¸ English
            </button>
        </li>
    </ul>
</div>

<style>
    .culture-switcher .dropdown-menu {
        z-index: 9999 !important;
        border: 1px solid rgba(255, 255, 255, 0.2);
        background-color: rgba(33, 37, 41, 0.95);
        backdrop-filter: blur(10px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .culture-switcher .dropdown-item {
        color: #fff;
        transition: all 0.2s ease;
    }
    
    .culture-switcher .dropdown-item:hover {
        background-color: rgba(13, 110, 253, 0.8);
        color: #fff;
    }
    
    .culture-switcher .dropdown-item.active {
        background-color: #0d6efd;
        color: #fff;
    }
</style>

@code {
    private string GetCurrentCultureDisplay()
    {
        return CultureInfo.CurrentUICulture.Name switch
        {
            "tr-TR" => "TR",
            "en-US" => "EN",
            _ => "TR"
        };
    }

    private bool IsCurrentCulture(string cultureName)
    {
        return CultureInfo.CurrentUICulture.Name == cultureName;
    }

    private async Task ChangeCultureAsync(string cultureName)
    {
        if (CultureInfo.CurrentUICulture.Name != cultureName)
        {
            await CultureService.SetCultureAsync(cultureName);
        }
    }
}